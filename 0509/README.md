# 10주차 강의 내용

시스템프로그래밍05.pdf - copy.c ~

## 파일 시스템 구조

- 부트 블록(Boot block)
  - 파일 시스템 시작부에 위치하고 보통 첫 번째 섹터를 차지
  - 부트스트랩 코드가 저장되는 블록

- 슈퍼 블록(Super block)
  - 전체 파일 시스템에 대한 정보를 저장
    - 총 블록 수, 사용 가능한 i-노드 개수, 사용 가능한 블록 비트 맵, 블록의 크기, 사용 중인 블록 수, 사용 가능한 블록 수 등

- i-리스트(i-list)
  - 각 파일을 나타내는 모든 i-노드들의 리스트
  - 한 블록은 약 40개 정도의 i-노드를 포함

- 데이터 블록(Data block)
  -  파일의 내용(데이터)을 저장하기 위한 블록들

rom ? 

부팅 시 rom에서 하는 작업은?

1. 전원 공급 후 초기화(Power-On Self Test, POST)

2. BIOS/UEFI 실행

3. 부트 디바이스 검색 및 선택

4. 부트 로더 로드

### i-노드(i-Node)

- __한 파일은 하나의 i-노드를 갖는다.__

- 파일에 대한 모든 정보를 가지고 있음
  - 파일 타입: 일반 파일, 디렉터리, 블록 장치, 문자 장치 등
  - 파일 크기
  - 사용권한
  - 파일 소유자 및 그룹
  - 접근 및 갱신 시간
  - 데이터 블록에 대한 포인터(주소) 등

### 블록 포인터

- 데이터 블록에 대한 포인터
  - 파일의 내용을 저장하기 위해 할당된 __데이터 블록의 주소__

- 하나의 i-노드 내의 __블록 포인터__
  - 직접 블록 포인터 10개
  - 간접 블록 포인터 1개
  - 이중 간접 블록 포인터 1개

## 파일 입출력 구현
- 파일 입출력 구현을 위한 커널 내 자료구조
	- 파일 디스크립터 배열(Fd array)
## 파일 입출력 구현
- 파일 입출력 구현을 위한 커널 내 자료구조
	- 파일 디스크립터 배열(Fd array)
	- 열린 파일 테이블(Open File Table)
	- 동적 i-노드 테이블(Active i-node table)

## 파일 디스크립터 배열(Fd Array)
- 프로세스 당 하나씩 갖는다.
- 파일 디스크립터 배열
	- 열린 파일 테이블의 엔트리를 가리킨다.
- 파일 디스크립터
	- 파일 디스크립터 배열의 인덱스
	- 열린 파일을 나타내는 번호

## 열린 파일 테이블(Open File Table)
- 파일 테이블 (file table)
	- 커널 자료구조
	- __열려진 모든 파일 목록__
	- 열려진 파일  파일 테이블의 항목
- 파일 테이블 항목 (file table entry)
	- __파일 상태__ 플래그
		(read, write, append, sync, nonblocking,…)
	- __파일의 현재 위치__ (current file offset)
	- i-node에 대한 포인터

## 동적 i-노드 테이블(Active i-node Table)
- 동적 i-노드 테이블
	- 커널 내의 자료 구조
	- __Open 된 파일들의 i-node를 저장하는 테이블__
- i-노드
	- 하드 디스크에 저장되어 있는 파일에 대한 자료구조
	- __한 파일에 하나의 i-node__
	- 하나의 파일에 대한 정보 저장
		- 소유자, 크기
		- 파일이 위치한 장치
		- 파일 내용 디스크 블럭에 대한 포인터
- i-node table vs. i-node

## 파일 상태(file status)
- 파일 상태
  - 파일에 대한 모든 정보
  - 블록수, 파일 타입, 사용 권한, 링크수, 파일 소유자의 사용자 ID,
  - 그룹 ID, 파일 크기, 최종 수정 시간 등
- 예
$ ls -l hello.c
2 -rw-r--r-- 1 chang cs 617 11월 17일 15:53 hello.c
블록수 사용권한 링크수 사용자ID 그룹ID 파일 크기 최종 수정 시간 파일이름
파일 타입

## 상태 정보 : stat()
- 파일 하나당 하나의 i-노드가 있으며
- i-노드 내에 파일에 대한 모든 상태 정보가 저장되어 있다.

## stat 구조체

## 파일 타입

##파일 사용 권한(File permissions)
- 각 파일에 대한 권한 관리
	- 각 파일마다 사용권한이 있다.
	- 소유자(owner)/그룹(group)/기타(others)로 구분해서 관리한다.
- 파일에 대한 권한
	- 읽기 r
	- 쓰기 w
	- 실행 x

## 사용권한
- read 권한이 있어야
	- O_RDONLY O_RDWR 을 사용하여 파일을 열 수 있다
- write 권한이 있어야
	- O_WRONLY O_RDWR O_TRUNC 을 사용하여 파일을 열 수 있다
- 디렉토리에 __write 권한과 execute 권한__ 이 있어야
	- 그 디렉토리에 파일을 생성할 수 있고
	- 그 디렉토리의 파일을 삭제할 수 있다
	- 삭제할 때 그 파일에 대한 read write 권한은 없어도 됨

## 파일 사용 권한

시스템프로그래밍07.pdf list2.c 까지지
